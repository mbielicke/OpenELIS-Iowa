<!-- ======================================================================= -->
<!-- JBoss build file                                                       -->
<!-- ======================================================================= -->

<!-- <project xmlns:ivy="antlib:org.apache.ivy.ant" name="ELIS" basedir="."> -->
<project name="ELIS" basedir=".">

<!-- 	<taskdef resource="org/apache/ivy/ant/antlib.xml" -->
<!-- 			         uri="antlib:org.apache.ivy.ant" classpath="/usr/share/java/ivy.jar"/> -->
	
<!-- 	<mkdir dir="deploylib"/> -->
	
<!-- 	<ivy:configure file="ivysettings.xml"/> -->
<!-- 	<ivy:resolve/> -->
<!-- 	<ivy:retrieve conf="deploy" pattern="deploylib/[artifact]-[revision].[ext]" sync="true"/> -->
	
	<delete file="build/openelis.war" />
	<war destFile="build/openelis.war" baseDir="../OpenELIS-GWT/war">
		<exclude name="WEB-INF/lib/gwt-servlet.jar" />
		<exclude name="WEB-INF/classes/org/openelis/manager/*"/>
	</war>
	
	<delete file="build/openelisweb.war"/>
	<war destFile="build/openelisweb.war" baseDir="../OpenELIS-Portal/war">
	    <exclude name="WEB-INF/lib/gwt-servlet.jar" />
	    <exclude name="WEB-INF/classes/org/openelis/manager/*"/>
    </war>

	<delete file="build/openelis.jar" />
	<copy file="src/resources/META-INF/ehcache.xml" todir="bin" overwrite="true" />
	<copy file="src/resources/META-INF/dataExchangeDefault.xsl" todir="bin" overwrite="true" />
	<jar jarfile="build/openelis.jar">
		<fileset dir="bin">
			<include name="org/openelis/bean/*.class" />
			<include name="org/openelis/manager/*.class" />
			<include name="org/openelis/entity/*.class" />
			<include name="org/openelis/local/*.class" />
			<include name="org/openelis/report/**/*" />
			<include name="org/openelis/utils/*.class" />
            <include name="org/openelis/scriptlet/*.class" />
			<exclude name="org/openelis/report/**/*.jrxml" />
			<include name="ehcache.xml" />
			<include name="dataExchangeDefault.xsl" />
		</fileset>
		<fileset dir="src/resources/">
			<include name="META-INF/persistence.xml" />
			<include name="META-INF/ehcache.xml" />
<!-- 			<include name="META-INF/beans.xml"/> -->
		</fileset>
		<fileset dir="../OpenELIS-Common/bin">
			<include name="org/openelis/manager/*.class" />
	    </fileset>
	</jar>
	
	<delete file="build/openelis-portal.jar"/>
	<jar jarfile="build/openelis-portal.jar">
		<fileset dir="bin">
			<include name="org/openelis/stfu/bean/FinalReportPortalBean.class"/>
			<include name="org/openelis/stfu/bean/MessageBean.class"/>
			<include name="org/openelis/stfu/bean/SampleStatusPortalBean.class"/>
			<include name="org/openelis/stfu/bean/UserResponsePortalBean.class"/>
<!-- 			<include name="org/openelis/stfu/bean/*.class"/> -->
<!-- 			<include name="org/openelis/stfu/manager/*.class"/> -->
<!-- 			<include name="org/openelis/stfu/entity/*.class"/> -->
		</fileset>
<!-- 		<fileset dir="src/resources/"> -->
<!-- 			<include name="META-INF/beans.xml"/> -->
<!-- 		</fileset> -->
<!-- 		<fileset dir="../OpenELIS-Common/bin"> -->
<!-- 			<include name="org/openelis/stfu/manager/*.class"/> -->
<!-- 	    </fileset> -->
	</jar>

	<delete file="build/openelis-common.jar" />
	<copy file="../OpenELIS-Common/src/org/openelis/constants/OpenELISWebConstants.properties" todir="../OpenELIS-Common/bin/org/openelis/constants"/>
	<jar jarfile="build/openelis-common.jar">
		<fileset dir="../OpenELIS-Common/bin">
			<include name="org/openelis/constants/*" />
			<include name="org/openelis/domain/*.class" />
			<include name="org/openelis/exception/*.class" />
			<include name="org/openelis/scriptlet/*.class" />
			<!--<include name="org/openelis/manager/*.class" /> -->
			<include name="org/openelis/messages/*.class" />
			<include name="org/openelis/meta/*.class" />
			<include name="org/openelis/remote/*.class" />
			<include name="org/openelis/report/*.class" />
			<include name="org/openelis/utilcommon/*.class" />
<!-- 			<include name="org/openelis/stfu/domain/*.class"/> -->
			<!--<include name="org/openelis/stfu/manager/*.class"/>-->
		</fileset>
	</jar>
	
	<delete file="build/security-client.jar" />
	<jar jarfile="build/security-client.jar">
		<fileset dir="../Security/bin">
			<include name="org/openelis/security/domain/*.class" />
			<include name="org/openelis/security/remote/*.class" />
		</fileset>
	</jar>
    
	<copy file="../OpenELIS-Lib/openelis-lib.jar" todir="./lib" overwrite="true" />
	<copy file="../OpenELIS-GWT/war/WEB-INF/lib/gwt-servlet.jar" todir="./lib" overwrite="true" />
	<copy file="../OpenELIS-UI/ui.jar" todir="./lib" overwrite="true" failonerror="false"/>
	<delete file="build/openelis.ear" />
	<ear destfile="build/openelis.ear" appxml="src/resources/META-INF/application_portal.xml">
	    <fileset dir="src/resources/">
	       <include name="META-INF/jboss-app.xml"/>
	    </fileset>
		<fileset dir="build">
			<include name="openelis.jar" />
		</fileset>
		<fileset dir="build">
			<include name="openelis.war" />
		</fileset>
		<fileset dir="build">
			<include name="openelisweb.war" />
	    </fileset>
		<fileset dir="build">
			<include name="openelis-portal.jar"/>
		</fileset>
		<fileset dir="build">
			<include name="openelis-common.jar"/>
	    </fileset>
		<fileset dir="build">
			<include name="security-client.jar" />
		</fileset>
<!-- 		<zipfileset dir="deploylib" prefix="lib" includes="*.jar"/> -->
		<fileset dir=".">
			<include name="lib/openelis-lib.jar" />
			<include name="lib/ui.jar" />
			<include name="lib/commons-collections-3.2.1.jar"/>
			<include name="lib/poi-3.6-20091214.jar" />
            <include name="lib/poi-ooxml-3.6-20091214.jar" />
            <include name="lib/poi-ooxml-schemas-3.6-20091214.jar" />
            <include name="lib/xmlbeans-2.3.0.jar" />
            <include name="lib/dom4j-1.6.1.jar" />
			<include name="lib/iText-2.1.7.jar" />
			<include name="lib/jcommon-1.0.15.jar" />
			<include name="lib/jfreechart-1.0.12.jar" />
			<include name="lib/groovy-all-1.7.5.jar" />
			<include name="lib/barbecue-1.5-beta1.jar" />
			<include name="lib/commons-digester-1.7.jar" />
			<include name="lib/ehcache-1.2.jar" />
			<include name="lib/commons-beanutils-1.8.2.jar" />
			<include name="lib/jasperreports-4.0.1.jar" />
			<include name="lib/gwt-servlet.jar" />
			<!--<include name="lib/gwt-user.jar"/>-->
			<include name="lib/javamail.jar" />
			<include name="lib/commons-fileupload-1.2.1.jar"/>
			<include name="lib/commons-io-2.1.jar"/>
			<include name="lib/gwt-i18n-server-0.22.jar"/>
			<include name="lib/report-fonts.jar"/>
		</fileset>
	</ear>
<!--
	<copy file="build/openelis.ear" todir="/usr/local/java/jboss-as-7.1.1.Final/standalone/deployments"/>

	<delete dir="deploylib"/>
-->
</project>

