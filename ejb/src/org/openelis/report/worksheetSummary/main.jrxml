<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="holdRefuseOrganization" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.callouts" value="##Tue Sep 21 15:30:40 CDT 2010"/>
	<import value="java.util.Calendar"/>
	<import value="org.openelis.ui.common.DataBaseUtil"/>
	<parameter name="USER_NAME" class="java.lang.String">
		<defaultValueExpression><![CDATA["unknown"]]></defaultValueExpression>
	</parameter>
	<parameter name="WORKSHEET_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select w.id w_id, w.created_date, w.description, i.name i_name, wi.position, wa.from_other_id,
       t.name t_name, m.name m_name, s.accession_number, q.name qc_name, ql.lot_number,
       d1.entry a_unit, d2.entry qc_unit, d3.entry qc_type, d3.code, wa1.accession_number qc_link,
       wi2.worksheet_id fo_w_id, wi2.position fo_position
  from worksheet w, worksheet_item wi, worksheet_analysis wa, outer instrument i,
       outer(analysis a, test t, method m, sample_item si, sample s, outer dictionary d1),
       outer(qc_lot ql, qc q, dictionary d2, outer dictionary d3),
       outer(worksheet_analysis wa1),
       outer(worksheet_analysis wa2, worksheet_item wi2)
 where w.instrument_id = i.id and
       wi.worksheet_id = w.id and
       wa.worksheet_item_id = wi.id and
       wa.worksheet_analysis_id = wa1.id and
       wa.from_other_id = wa2.id and
       wa2.worksheet_item_id = wi2.id and
       wa.analysis_id = a.id and
       a.test_id = t.id and
       t.method_id = m.id and
       a.unit_of_measure_id = d1.id and
       a.sample_item_id = si.id and
       si.sample_id = s.id and
       wa.qc_lot_id = ql.id and
       ql.qc_id = q.id and
       ql.prepared_unit_id = d2.id and
       q.type_id = d3.id and
       w.id = $P{WORKSHEET_ID}
order by 1,5]]>
	</queryString>
	<field name="w_id" class="java.lang.Integer"/>
	<field name="created_date" class="java.sql.Timestamp"/>
	<field name="description" class="java.lang.String"/>
	<field name="i_name" class="java.lang.String"/>
	<field name="position" class="java.lang.Integer"/>
	<field name="from_other_id" class="java.lang.Integer"/>
	<field name="t_name" class="java.lang.String"/>
	<field name="m_name" class="java.lang.String"/>
	<field name="accession_number" class="java.lang.Integer"/>
	<field name="qc_name" class="java.lang.String"/>
	<field name="lot_number" class="java.lang.String"/>
	<field name="a_unit" class="java.lang.String"/>
	<field name="qc_unit" class="java.lang.String"/>
	<field name="qc_type" class="java.lang.String"/>
	<field name="code" class="java.lang.String"/>
	<field name="qc_link" class="java.lang.String"/>
	<field name="fo_w_id" class="java.lang.Integer"/>
	<field name="fo_position" class="java.lang.Integer"/>
	<variable name="HEADER_DATE" class="java.util.Date" resetType="None">
		<variableExpression><![CDATA[new Date()]]></variableExpression>
	</variable>
	<pageHeader>
		<band height="48" splitType="Stretch">
			<staticText>
				<reportElement x="220" y="0" width="260" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" size="12" isBold="true" isUnderline="false" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Worksheet Summary]]></text>
			</staticText>
			<textField pattern="MMM dd, yyyy">
				<reportElement x="0" y="0" width="100" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="10" isUnderline="false" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$V{HEADER_DATE}]]></textFieldExpression>
			</textField>
			<textField pattern="HH:mm:ss">
				<reportElement x="0" y="12" width="100" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="10" isUnderline="false" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$V{HEADER_DATE}]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="661" y="0" width="77" height="12"/>
				<textElement textAlignment="Right">
					<font fontName="Times New Roman" size="10" isUnderline="false" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER} + " of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" pattern="">
				<reportElement x="742" y="0" width="10" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="10" isUnderline="false" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="657" y="12" width="95" height="12"/>
				<textElement textAlignment="Right">
					<font fontName="Times New Roman" size="10" isUnderline="false" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{USER_NAME}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="0" y="36" width="60" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement>
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Worksheet ID]]></text>
			</staticText>
			<textField>
				<reportElement x="60" y="36" width="50" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{w_id}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="110" y="36" width="40" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement>
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Created]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="270" y="36" width="225" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{description}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="215" y="36" width="55" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement>
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Description]]></text>
			</staticText>
			<textField pattern="yyyy-MM-dd HH:mm">
				<reportElement x="150" y="36" width="65" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{created_date}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="495" y="36" width="55" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement>
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Instrument]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="550" y="36" width="202" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{i_name}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="12" splitType="Stretch">
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="60" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Position]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="60" y="0" width="100" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Worksheet Lookup]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="160" y="0" width="60" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Accession #]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="220" y="0" width="60" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[QC Link]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="280" y="0" width="100" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Test / QC]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="380" y="0" width="100" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Method / QC Lot #]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="480" y="0" width="100" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[QC Type]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="580" y="0" width="60" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[QC Code]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="640" y="0" width="112" height="12" forecolor="#FFFFFF" backcolor="#000000"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[Units]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="24">
			<textField>
				<reportElement x="0" y="0" width="60" height="12"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[DataBaseUtil.concatWithSeparator($F{w_id}, ".", $F{position})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="60" y="0" width="100" height="12"/>
				<textElement textAlignment="Center">
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{qc_link} != null ? DataBaseUtil.concatWithSeparator($F{qc_link}, "@", $F{code}) : $F{accession_number} != null ? $F{accession_number} : $F{fo_w_id} != null ? DataBaseUtil.concatWithSeparator($F{fo_w_id}, ".", $F{fo_position}) : DataBaseUtil.concatWithSeparator($F{w_id}, ".", $F{position})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="0" width="60" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{accession_number} != null ? $F{accession_number} : $F{fo_w_id} != null ? DataBaseUtil.concatWithSeparator($F{fo_w_id}, ".", $F{fo_position}) : DataBaseUtil.concatWithSeparator($F{w_id}, ".", $F{position})]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="220" y="0" width="60" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{qc_link}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="280" y="0" width="100" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{t_name} != null ? $F{t_name} : $F{qc_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="380" y="0" width="100" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{m_name} != null ? $F{m_name} : $F{lot_number}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="480" y="0" width="100" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{qc_type}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="580" y="0" width="60" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{code}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="640" y="0" width="112" height="12"/>
				<textElement>
					<font fontName="Times New Roman" size="8" pdfFontName="Times-Roman"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{a_unit} != null ? $F{a_unit} : $F{qc_unit}]]></textFieldExpression>
			</textField>
			<componentElement>
				<reportElement key="accessionNumber.barcode" mode="Opaque" x="0" y="12" width="60" height="12"/>
				<jr:barbecue xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" type="3of9" drawText="false" checksumRequired="false">
					<jr:codeExpression><![CDATA[DataBaseUtil.concatWithSeparator($F{w_id}, ".", $F{position})]]></jr:codeExpression>
				</jr:barbecue>
			</componentElement>
			<componentElement>
				<reportElement key="accessionNumber.barcode" mode="Opaque" x="60" y="12" width="100" height="12"/>
				<jr:barbecue xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" type="3of9" drawText="false" checksumRequired="false">
					<jr:codeExpression><![CDATA[$F{qc_link} != null ? DataBaseUtil.concatWithSeparator($F{qc_link}, "@", $F{code}) : $F{accession_number} != null ? $F{accession_number} : $F{fo_w_id} != null ? DataBaseUtil.concatWithSeparator($F{fo_w_id}, ".", $F{fo_position}) : DataBaseUtil.concatWithSeparator($F{w_id}, ".", $F{position})]]></jr:codeExpression>
				</jr:barbecue>
			</componentElement>
		</band>
	</detail>
</jasperReport>
